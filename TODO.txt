mahmoud should remove unecessary malloc protections
